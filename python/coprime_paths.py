#!/bin/python3

# Testing for https://www.hackerrank.com/challenges/coprime-paths/problem

# My Code

def get_coprime_pairs(nodes, adj_dict, u, v):
  chain = bfs(adj_dict, u, v)
  return chain
  num_coprimes = 0
  for i in range(len(chain)):
    for j in range(i+1, len(chain)):
      if gcd(nodes[chain[i] - 1], nodes[chain[j] - 1]) == 1:
        num_coprimes += 1
  return num_coprimes

def _gcd(x, y):
  return math.gcd(x, y)

def memoize(func):
  mem = {}
  def memoized(*args):
    strargs = str(args)
    if strargs not in mem:
      mem[strargs] = func(*args)
    return mem[strargs]
  return memoized

memoized_gcd = memoize(_gcd)
def gcd(x, y):
  if x > y:
    return memoized_gcd(y, x)
  return memoized_gcd(x, y)

def bfs(adj_dict, start, end):
  queue = deque([(start, [start])])
  seen = set([])
  while (queue):
    cur, chain = queue.popleft()
    if cur == end:
      return chain
    if cur not in seen:
      seen.add(cur)
      for neighbor in adj_dict[cur]:
        queue.append((neighbor, chain + [neighbor]))
  return []

# uses too much space, just using math.gcd instead
def build_factors(max_n):
  factors = [set([1, i]) for i in range(max_n + 2)]
  cur = 2
  while cur * cur <= max_n:
    if len(factors[cur]) == 2:
      for i in range(cur * 2, max_n + 2, cur):
        factors[i].add(cur)
    cur += 1
  def factor(n):
    return factors[n]
  return factor

def build_adj_dict(edges):
  edge_dict = defaultdict(list)
  for i, o in edges:
    edge_dict[i].append(o)
    edge_dict[o].append(i)
  return edge_dict



# testing

testcase = """
778 695
205215 3007846 7015335 2444240 7969812 3896650 7288379 5545161 9804999 2775634 5658524 5649413 259713 2026812 2317594 948601 1125093 4712766 976853 4420926 7402976 3614266 6666761 3665372 9074185 5001093 411131 4609673 4960842 2008035 5266153 2843733 7266139 5333975 8898138 436621 1692877 3383981 420698 9361775 5960936 2300476 8751371 1087703 572967 8999633 4464887 1703371 4692367 6135018 1059929 1176893 2602667 8855432 3998007 1004498 4651583 9943861 4924775 1424594 5204957 3960444 3902044 2026949 1247949 3934901 7517313 9324558 9966047 4254444 7494262 126212 8752063 5238457 219361 1469997 3442256 2379997 7237782 3881447 4509369 2222503 6599452 6766491 6608963 5570317 7920518 6882763 4045735 5812681 1721719 5824330 1368581 9602371 6141167 2266273 9580184 2804456 5146765 5894879 1519487 601377 7921909 161689 3016667 380647 8087093 7960928 3522349 8286475 9125299 6376523 3880805 6099571 6894094 5213541 7025681 3785667 9138617 4433607 2222689 555250 260354 4089123 3571982 828299 9234268 8229463 2027602 211809 8614787 3253507 5535125 9652581 9161809 7735009 1202294 5897077 1188492 6283232 5611765 9451211 8258047 519604 2250593 28334 4732297 7369424 3660627 1931674 7064351 9597501 4795051 4342943 1660964 3002843 3845414 3800176 4267988 9796728 6701215 7298413 1833809 7015331 3259043 4254249 6485300 6964341 523682 114415 9508916 3888231 8870591 1402057 8621624 1233413 6936805 1687712 9777953 9896294 5464544 9731827 8940787 6496769 2802033 4730942 6581756 2384399 4723504 9096721 5985604 293613 5581143 3717577 3148589 973925 1339967 6825379 4760957 7186962 513713 2211494 4083291 6157555 3081205 9012911 7053908 254948 5353747 4972363 6208121 6024527 2760115 1218369 3027842 3532446 2030894 1010794 9437398 6265801 394711 9510758 5781451 5843746 3912413 6646607 6203131 3423216 7947428 9983755 6946107 4174526 4833008 9958826 5903497 5135375 9697892 3894769 3636214 3090554 3625653 7041828 2765311 2441649 1666871 7512121 3230398 4240934 7466337 7646924 3363124 4851370 5589068 7205797 8802553 1694417 7286221 6794817 4419003 8895609 7627484 9197978 6507304 6157248 9361187 6071682 6352702 6378035 6780566 229294 2287602 6721055 7296013 529983 6475108 8074782 2158924 7951288 6591237 6888784 5526201 9863121 5187831 4941787 455477 9260811 7962541 451118 2423567 4756123 670181 2610157 8715059 4181263 3987426 3154978 4671611 3519664 3229733 5652701 8781101 1724332 4226425 3484973 4320496 6863273 1160955 9272051 676247 204502 5680079 2481168 3257763 459251 5060507 8607972 550408 165028 7885633 6627057 1034871 2350169 8525804 238508 3308393 9689471 4596245 2344854 6969706 5147206 868808 3730224 7135667 8154963 8434034 8650103 3985353 7621739 7034815 6428011 8577475 1303673 7807070 292894 2290508 8654206 553213 5623498 2578491 1776301 3616705 7509422 7391057 7763902 6775376 7565888 9483 3891151 6085475 175002 845677 6646943 9581395 5422501 3643880 5204073 506827 4617527 6683654 4508908 4041637 5701 2956693 1134305 2849578 394666 3198601 9337151 258010 9276350 6389939 4467608 8029359 4496782 6110489 1139303 2635064 7022021 5318901 9918634 3204034 452351 1726476 3533266 244021 5643873 8770169 8469148 5720096 9537553 3891903 162521 4672443 3821575 6927905 2480377 2247116 5556729 4576397 1671742 2275681 7633408 7444981 8524059 3457829 3456625 6860939 9702754 7006218 8430093 2385401 3192453 1285775 2864894 8051713 642717 51677 6391809 2936881 6905954 7624325 4320301 2570606 3541779 2817176 62989 6478298 929381 7179647 3074721 1506039 9945352 57392 2878342 7431971 7303258 4595993 5178241 73079 2862568 5663511 4224929 7237036 2628847 4629447 484621 335374 3195241 9414101 4894832 3780309 7757056 1868452 4660276 4339316 1352408 9360401 9003769 5776922 8680288 2938767 8045671 8881697 207818 8378791 3962859 5369003 6854687 7821053 7626931 5975231 1862444 3704959 9715841 3356774 6893668 4597011 7576502 9086134 2266974 2690441 5501075 2432356 5449451 8808131 8970013 9701071 2766557 7861253 1899922 3976703 4058129 8889256 9065946 9582327 5786966 721257 6529857 2317627 1075555 2608768 9204237 4319129 5752958 6659914 6094499 1771387 1064901 5523007 9455013 2055237 8448537 4901849 7423678 7612015 960367 735544 7044067 3172219 8944399 1120421 6715613 9250216 8416791 7301533 584858 3651954 3208462 7085451 5500689 5286307 5486787 868801 1436844 4015617 5120294 6911852 1520482 625562 1713312 9170926 2277839 5340185 6267176 7214137 6574388 626311 9214633 6747719 9806672 1267363 5204591 3720205 2704277 4632091 3405348 7391393 7596012 6863732 6605064 9887992 7546328 190766 3419049 2610806 1477095 18825 1916800 9520214 522926 5469871 6896621 8472504 1232675 1408045 4254212 6952943 1530416 9653942 5938148 8050384 3124381 5873189 5558777 3479513 8556432 6414280 5740916 9435071 3538191 8100845 3735369 8220734 742343 2235584 1661783 6874553 9134596 3241153 4836628 7752341 7179534 2400499 5018881 9686811 296981 9952587 3435072 3376517 4362682 4169866 6291919 6899903 7697792 8710389 6326209 2563669 6558714 4782101 2551495 3011590 576925 3338172 2002173 2726085 9262964 1215953 4878217 5691353 2458474 1969445 3715612 8478185 4555973 3082249 6066912 1318522 9174833 1416296 2925057 4549355 4442626 5847004 5181523 7730444 8258618 2591635 2273671 4879853 7921361 2699941 2685931 6261484 359045 2170629 6600719 8898618 6638599 3462862 3298943 8760515 5590756 7100137 718414 8843774 5188559 9469113 6789350 159599 6194593 3784277 8696918 6648262 266513 3695683 9600771 1277977 7064144 465506 5232271 4687502 8176808 8980075 2933948 6541646 309261 4577254 4230457 3488013 8727703 6418855 1824968 5796268 2119765 2033725 3501553 5678087 8941069 4088582 4163350 1838051 7990214 7279669 8331193 6075803 8721984 5492164 9218128 5634623 9774251 3216335 2650073 1083659 2254232 6985032 518764 1745483 3180962 1760815 5933127 6066695 4128319 6050177 7246751 7298924 5703529 906382 6418582 888561 3754295 2831445 4793322 6457949 693644 5476917 1711245 8387917 4966477 1882805 5131958 7419143 424465 8820502 3065401 1414774 9938249 4862800 7279743 94201 5485503 4560223 2317688 216293 5579635 1705565 9497091 3985182 6384920 6909013 1998219 8021861 2167801 7369297 3076177 9797924 8984593 9143543 3923317
103 384
116 384
179 103
237 103
528 116
682 528
162 103
456 179
658 682
494 528
760 528
510 658
679 658
42 103
61 456
500 494
142 103
516 142
530 103
678 516
62 116
496 61
15 500
83 62
57 510
43 83
404 15
204 760
676 103
236 510
293 116
733 510
627 676
503 494
68 384
40 62
358 57
435 103
512 42
761 510
463 676
169 293
110 103
193 500
430 15
650 384
680 435
180 680
255 15
56 503
102 456
167 68
674 116
693 15
765 61
332 496
286 510
359 42
712 237
460 682
429 169
505 15
91 516
357 193
32 463
341 204
683 193
181 142
685 679
552 494
239 516
672 103
275 167
673 528
529 733
701 91
344 179
383 658
768 701
377 673
476 181
734 275
730 683
417 712
178 162
46 673
408 674
30 460
681 358
87 650
305 181
593 344
243 42
459 681
78 204
452 239
72 404
557 505
484 169
439 500
468 43
329 358
338 557
763 341
225 236
563 87
775 528
436 496
185 658
127 61
129 102
599 505
414 116
729 129
55 180
176 404
342 43
203 463
660 78
244 761
746 417
487 193
297 169
690 673
609 225
728 56
274 357
330 176
294 682
153 436
369 153
443 557
527 193
60 730
773 730
562 286
292 72
533 459
371 338
409 153
113 599
210 42
282 62
659 627
387 55
759 562
423 679
756 678
277 15
284 162
464 42
349 91
335 103
738 676
418 773
12 255
586 294
415 32
201 439
444 586
108 529
581 676
767 239
749 244
279 746
155 62
596 672
233 775
273 712
448 204
86 383
434 275
454 286
652 332
587 759
117 56
397 434
447 775
662 46
260 682
727 275
165 46
374 377
327 763
206 127
26 43
630 436
684 418
411 255
17 155
353 404
694 102
346 690
615 701
714 42
619 404
266 615
537 436
543 682
112 463
764 436
254 117
74 436
731 627
368 342
638 330
628 305
218 414
407 273
140 619
449 236
160 176
170 407
8 359
613 680
194 727
691 734
542 430
154 763
640 162
124 409
766 449
352 384
506 409
24 404
574 346
736 407
362 417
7 500
485 112
314 113
205 335
238 684
686 169
222 512
71 494
710 599
88 371
427 712
461 371
302 341
742 404
89 359
518 674
641 650
41 676
188 447
325 662
776 619
580 292
85 505
156 734
100 178
144 686
698 503
547 414
584 574
350 327
614 83
385 68
241 156
769 46
183 85
725 476
118 193
326 88
651 679
141 193
145 113
507 344
758 701
774 447
666 543
159 279
480 506
532 108
217 7
379 222
22 110
514 15
661 659
16 236
646 350
259 587
697 60
561 185
262 325
214 108
403 55
301 116
649 359
515 144
720 89
197 599
754 116
227 201
737 362
396 254
612 374
541 181
491 638
440 448
578 765
709 609
762 729
261 62
392 129
36 154
132 494
671 596
571 302
258 407
234 686
722 729
48 301
151 506
148 407
104 185
644 26
531 414
54 234
585 737
97 244
670 408
9 701
642 225
10 305
269 16
137 104
735 282
77 543
600 760
442 137
711 78
455 142
502 15
267 485
665 505
629 749
79 7
422 103
221 112
166 760
401 374
386 468
568 293
39 57
109 734
654 359
76 615
37 641
611 86
4 254
323 350
732 180
633 628
745 179
472 649
395 452
84 600
317 709
136 456
425 714
340 197
334 444
467 684
106 759
312 369
28 487
296 720
272 353
536 409
257 463
95 644
708 284
618 78
591 404
474 56
198 758
416 4
643 736
495 312
157 515
675 243
370 358
81 4
285 404
703 467
482 646
595 335
372 302
287 87
354 76
465 673
249 510
191 505
336 684
195 515
373 731
45 756
716 145
21 362
356 282
702 456
695 682
173 675
477 191
648 571
101 773
268 217
105 181
216 395
657 619
223 162
554 201
498 430
598 344
453 312
231 204
772 274
748 641
111 772
138 630
594 241
6 745
224 660
1 648
707 758
363 113
31 282
413 1
59 554
184 137
80 415
623 203
582 729
523 317
445 585
380 756
50 665
626 59
604 455
114 730
603 185
747 237
717 670
382 217
187 137
248 464
378 468
208 644
493 552
721 484
321 594
96 461
517 296
2 91
303 665
271 7
283 691
322 110
620 303
508 184
550 536
470 516
351 359
724 659
98 193
199 359
82 85
420 100
99 114
504 444
621 504
520 78
497 768
704 681
209 594
3 255
777 463
394 452
524 216
426 227
366 717
308 317
573 494
364 351
281 417
265 695
174 557
473 749
388 287
150 640
558 630
421 353
405 747
481 208
538 55
647 155
319 765
107 45
70 621
192 352
602 39
315 459
252 698
588 272
228 502
492 484
242 101
616 104
635 346
120 681
634 588
339 80
608 694
278 216
469 640
743 620
11 7
706 409
715 162
548 184
589 8
692 286
130 678
740 562
33 43
428 773
567 374
677 635
375 301
219 724
251 722
544 72
213 358
126 465
753 314
29 2
177 702
361 640
466 236
631 187
592 86
509 254
744 104
58 239
501 401
607 397
590 465
540 91
486 477
134 370
622 676
13 137
25 724
147 538
67 703
513 322
298 4
324 439
713 96
152 409
438 344
457 671
560 661
757 523
667 283
645 738
143 36
597 571
355 595
247 408
726 58
360 388
365 677
511 464
164 704
94 764
669 683
320 339
270 659
750 467
553 160
664 109
637 574
639 484
348 612
437 670
52 319
570 9
311 536
376 257
535 437
475 456
389 277
625 425
488 595
632 124
313 652
617 683
131 370
556 311
689 495
575 669
398 423
172 384
289 493
69 725
483 95
189 58
38 672
64 395
226 726
220 332
149 661
158 260
200 632
331 472
263 422
441 507
253 323
668 237
18 126
295 160
367 372
576 506
65 159
182 480
462 501
307 294
161 60
549 763
347 465
687 307
656 149
328 281
196 703
559 775
280 369
163 322
212 727
490 198
539 203
393 486
381 616
479 150
521 676
723 120
624 96
186 520
49 651
700 777
565 386
569 385
256 635
545 462
337 191
458 501
20 428
211 706
771 767
719 25
125 556
663 194
230 234
741 656
555 544
73 622
546 621
577 17
115 602
19 349
399 81
291 426
705 102
75 243
522 296
276 268
653 126
44 147
215 110
207 195
123 728
450 115
14 195
572 521
583 143
410 492
579 776
390 759
93 215
755 158
51 653
489 462
406 495
699 758
122 661
288 668
566 430
601 159
778 1
175 522
246 544
146 733
309 746
168 619
412 473
605 160
431 459
121 295
245 25
27 254
135 278
424 454
34 557
299 209
739 279
139 426
66 501
5 599
128 412
333 464
391 709
316 58
63 491
433 666
171 358
451 86
345 349
92 127
232 308
471 196
718 515
751 80
53 498
519 435
636 754
478 618
696 749
402 584
229 26
688 252
47 106
551 73
564 537
343 515
235 222
446 135
250 754
119 200
90 760
770 286
610 668
526 522
300 668
525 207
419 523
306 88
655 633
752 609
264 2
310 46
35 539
318 105
304 252
202 2
290 137
240 614
534 706
499 163
400 93
606 419
133 710
190 430
23 51
432 331
280 335
716 54
581 384
454 99
200 747
425 405
69 217
260 383
326 699
344 245
401 184
131 531
586 183
371 746
529 599
239 565
240 258
39 689
9 606
371 717
344 36
345 115
2 708
88 35
727 3
642 182
408 302
719 356
531 403
739 81
712 739
25 230
368 360
92 94
487 489
284 388
410 656
530 186
252 147
410 677
434 48
717 438
60 320
496 533
124 400
273 117
478 533
385 33
328 626
126 163
574 509
633 689
7 474
121 731
265 164
660 60
242 247
624 414
636 546
504 303
432 9
506 21
212 395
200 407
341 683
516 616
188 15
648 583
105 297
519 520
59 275
478 250
721 256
572 495
778 26
296 753
106 520
592 631
737 12
136 321
752 225
594 204
653 729
208 201
757 162
521 674
59 447
467 143
281 118
508 386
204 312
576 427
139 386
359 405
414 377
776 684
243 472
316 639
133 452
497 482
306 628
745 321
701 304
595 725
731 278
716 364
398 352
372 509
153 22
193 281
310 419
518 340
312 193
532 431
474 456
41 600
509 372
672 287
591 311
328 505
760 479
402 470
336 382
701 327
647 85
425 735
603 699
571 630
614 572
591 756
202 322
461 423
675 122
300 89
659 152
266 764
481 262
381 750
138 333
594 94
246 471
19 599
586 311
599 769
395 553
344 384
702 521
120 684
497 229
290 38
501 29
147 509
592 57
171 310
774 585
334 303
215 67
299 267
9 259
234 348
33 748
101 315
263 707
35 641
308 367
581 655
426 491
153 274
729 361
85 486
737 36
31 300
51 259
233 356
47 391
349 249
337 401
36 111
740 240
195 421
588 259
256 514
698 138
321 306
637 304
580 511
411 741
224 555
680 503
244 623
230 531
13 222
369 60
360 276
409 322
578 126
263 576
741 459
155 761
760 758
625 266
585 551
598 266
286 280
514 103
522 156
118 761
6 33
571 147
165 478
121 51
411 660
378 19
656 112
16 26
704 778
167 95
569 216
75 82
501 711
652 75
732 286
617 11
600 325
459 42
641 528
66 433
654 719
338 568
490 304
348 698
227 687
88 127
584 26
688 683
595 778
191 391
439 257
339 514
485 220
641 342
102 159
8 220
671 447
692 622
397 315
377 570
128 293
188 502
671 164
316 53
131 221
299 528
729 48
426 217
211 579
469 719
266 83
210 513
497 62
700 682
616 312
246 213
661 426
733 335
56 333
155 769
55 642
400 163
661 573
261 364
20 332
215 388
622 194
451 475
538 104
358 749
523 269
326 135
533 629
304 214
388 530
387 700
339 628
76 386
778 695
203 506
202 771
438 432
345 261
762 513
161 15
714 602
158 696
27 330
133 442
504 528
263 311
643 578
381 658
316 255
472 720
287 305
487 278
199 464
248 421
78 347
518 405
149 63
155 725
284 47
316 335
648 113
39 114
628 63
369 112
199 556
522 506
765 629
335 152
630 412
55 111
250 27
59 250
524 737
184 344
767 86
96 20
131 154
226 243
101 741
637 201
204 143
488 609
64 310
180 548
455 188
55 32
673 542
621 572
409 54
63 338
241 35
343 328
304 233
740 658
518 190
183 443
729 52
195 737
664 162
113 253
534 152
62 715
634 107
486 509
533 100
388 182
738 242
93 206
256 15
582 413
188 551
473 253
132 437
57 600
446 603
372 182
287 256
543 264
26 632
101 128
483 665
651 171
89 301
625 317
602 157
438 496
61 74
671 150
496 271
188 715
177 49
69 549
767 431
499 296
364 387
28 20
359 399
609 87
367 108
656 235
416 220
56 643
392 206
525 356
292 393
696 52
419 237
700 1
584 2
431 738
734 126
108 646
123 222
762 50
367 428
739 475
618 35
569 330
373 589
186 130
647 665
532 54
612 222
587 477
230 53
543 320
120 390
144 488
243 398
120 107
309 467
219 325
733 675
751 382
208 240
382 324
319 296
31 479
558 302
309 585
385 231
140 416
445 116
576 748
285 223
76 764
490 38
726 715
773 245
468 618
325 309
461 689
107 162
661 137
446 273
746 591
745 507
11 577
706 160
416 44
199 440
174 428
202 223
71 311
677 575
729 461
212 502
47 394
138 61
754 554
589 118
755 492
774 460
78 64
22 763
210 733
404 123
746 147
229 473
137 728
472 558
193 66
509 570
738 395
177 404
686 584
370 497
378 383
538 285
110 253
361 316
722 542
577 58
304 665
656 597
738 619
228 688
464 374
452 451
710 611
684 424
621 36
297 504
309 97
558 65
450 39
410 229
607 463
184 117
443 304
255 459
410 381
707 776
158 743
370 267
46 4
611 108
312 712
697 567
491 193
230 103
190 508
607 396
715 165
320 287
234 629
35 173
513 252
639 649
707 101
617 171
457 524
391 632
671 466
559 79
417 408
137 665
447 449
766 609
489 398
527 740
7 613
241 189
458 53
757 291
471 178
110 601
245 76
279 146
326 741
422 596
71 745
581 302
285 609
293 27
441 589
92 154
645 715
177 164
371 459
683 390
530 766
401 29
438 495
305 150
94 469
1 65
574 195
690 591
432 43
25 202
392 48
249 100
532 150
632 188
337 600
299 744
258 766
313 310
371 456
340 383
603 126
173 55
605 775
364 436
729 746
661 434
425 7
346 441
323 647
496 125
484 436
405 747
37 3
285 287
45 590
11 391
375 570
642 721
40 151
396 240
770 551
290 79
476 707
457 675
667 34
120 351
123 265
18 306
574 113
598 15
664 89
578 507
56 527
230 729
764 458
644 612
181 165
73 695
572 242
710 366
138 462
186 246
241 390
426 325
286 757
349 637
261 336
457 436
595 383
355 654
760 539
157 171
310 223
507 126
578 4
321 289
427 77
143 475
33 484
108 599
700 561
375 496
353 526
339 651
266 770
194 639
369 157
654 732
351 235
739 340
467 248
181 293
425 746
251 3
3 718
744 284
191 372
382 583
222 21
199 166
632 724
601 735
475 441
359 200
466 608
23 160
197 276
503 290
467 776
577 215
715 699
36 563
777 670
610 672
427 771
8 418
187 715
482 497
331 216
182 3
168 425
685 99
444 85
778 148
195 400
364 391
777 87
658 403
507 158
735 711
459 1
758 571
400 11
403 504
746 750
416 243
729 495
199 410
5 193
533 457
753 437
468 393
"""

# test harness

import math
import os
import random
import re
import sys
from collections import defaultdict, deque


if __name__ == '__main__':
    lines = testcase.split('\n')
    lines.pop(0)

    nq = lines.pop(0).split()

    n = int(nq[0])

    q = int(nq[1])

    nodes = list(map(int, lines.pop(0).rstrip().split()))

    edges = []

    for _ in range(n-1):
        edges.append(list(map(int, lines.pop(0).rstrip().split())))
    adj_dict = build_adj_dict(edges)

    for q_itr in range(q):
        u, v = [int(i) for i in lines.pop(0).split(' ')]
        print(get_coprime_pairs(nodes, adj_dict, u, v))

